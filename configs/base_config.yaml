# Base Configuration for Korean Embedding Expansion
# 차집합 추가 방식 (Qwen vocab 유지 + KORMo 차집합 추가)

# Model settings
model:
  kormo_model: "KORMo-Team/KORMo-10B-sft"
  qwen_model: "Qwen/Qwen3-Embedding-0.6B"
  device: "auto"
  torch_dtype: "bfloat16"  # bfloat16, float32, float16
  trust_remote_code: true

# Tokenizer settings
tokenizer:
  use_fast: false  # Slow tokenizer for better compatibility
  add_special_tokens: false
  max_length: 512

  # Filtering options for vocab diff extraction
  filter_special_tokens: true
  filter_control_chars: true
  filter_whitespace_only: true
  min_token_length: 1

# Embedding expansion settings (차집합 추가 방식)
embedding:
  # Strategy: "add_diff" (기존 유지 + 차집합 추가)
  strategy: "add_diff"

  # Initialization method: "mean" (평균 초기화)
  init_method: "mean"
  random_std: 0.02

  # Expand both input and output embeddings
  expand_input_embeddings: true
  expand_output_embeddings: true

  # Safety checks
  verify_decomposition: true
  skip_unknown_tokens: true

# GPU settings (6 GPUs out of 10)
hardware:
  num_gpus: 6
  gpu_ids: [4, 5, 6, 7, 8, 9]  # 사용할 GPU ID
  distributed_backend: "nccl"
  find_unused_parameters: false

  # Mixed precision
  use_bf16: true
  use_fp16: false

  # Data loading
  num_workers: 8
  pin_memory: true
  prefetch_factor: 2

# Paths
paths:
  # Input
  tokenizer_dir: "./tokenizer"
  vocab_diff_file: "./tokenizer/vocab_diff.json"
  vocab_diff_stats: "./tokenizer/vocab_diff_stats.json"
  analysis_report: "./logs/tokenizer_analysis.json"

  # Output
  expanded_model_dir: "./outputs/koqwen-expanded"

  # Checkpoints & logs
  checkpoint_dir: "./checkpoints"
  log_dir: "./logs"
  data_cache_dir: "./data"

# Logging
logging:
  level: "INFO"
  console: true
  file: true
  log_format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Evaluation samples
evaluation:
  korean_samples:
    - "오늘은 날씨가 정말 좋네요."
    - "병원 예약 확인 부탁드립니다."
    - "데이터 파이프라인 성능을 점검해야 합니다."
    - "한국어 토크나이저 확장 실험을 진행합니다."
    - "인공지능 기술이 빠르게 발전하고 있습니다."
    - "서울에서 부산까지 KTX로 이동했습니다."

  english_samples:
    - "The weather is really nice today."
    - "Please check my hospital appointment."
    - "We need to examine the data pipeline performance."
    - "Artificial intelligence technology is advancing rapidly."
    - "I traveled from Seoul to Busan by KTX."

# Random seed
seed: 42
